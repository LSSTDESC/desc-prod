#!/bin/bash

# Container entry point.

# start the parsltest server
if [ $1 = server ]; then
  /home/descprod/dev/desc-prod/test/run-server
  exit 0
fi

# Update parsl, desc-wfmon and desc-prod.
pip install parsl@git+https://github.com/parsl/parsl@desc#parsl[monitoring,workqueue]
RUN pip install git+https://github.com/LSSTDESC/desc-wfmon.git
cd /home/descprod/dev/desc-prod
git pull
cd /home/parsldev
/home/descprod/dev/desc-prod/server/start server
